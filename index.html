<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Generic Implementation of a PK/PD Model • campsismod</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
<link rel="icon" sizes="any" href="favicon.ico">
<link rel="manifest" href="site.webmanifest">
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Generic Implementation of a PK/PD Model">
<meta name="description" content="A generic, easy-to-use and expandable implementation of a pharmacokinetic (PK) / pharmacodynamic (PD) model based on the S4 class system. This package allows the user to read/write a pharmacometric model from/to files and adapt it further on the fly in the R environment. For this purpose, this package provides an intuitive API to add, modify or delete equations, ordinary differential equations (ODEs), model parameters or compartment properties (like infusion duration or rate, bioavailability and initial values). Finally, this package also provides a useful export of the model for use with simulation packages rxode2 and mrgsolve. This package is designed and intended to be used with package campsis, a PK/PD simulation platform built on top of rxode2 and mrgsolve'.">
<meta property="og:description" content="A generic, easy-to-use and expandable implementation of a pharmacokinetic (PK) / pharmacodynamic (PD) model based on the S4 class system. This package allows the user to read/write a pharmacometric model from/to files and adapt it further on the fly in the R environment. For this purpose, this package provides an intuitive API to add, modify or delete equations, ordinary differential equations (ODEs), model parameters or compartment properties (like infusion duration or rate, bioavailability and initial values). Finally, this package also provides a useful export of the model for use with simulation packages rxode2 and mrgsolve. This package is designed and intended to be used with package campsis, a PK/PD simulation platform built on top of rxode2 and mrgsolve'.">
<meta property="og:image" content="https://calvagone.github.io/campsismod.doc/logo.png">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">campsismod</a>

    <small class="nav-text text-warning me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.2.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="articles/campsismod.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/v01_model_creation.html">Create a minimalist model</a></li>
    <li><a class="dropdown-item" href="articles/v02_structural_model.html">Insight on the structural model</a></li>
    <li><a class="dropdown-item" href="articles/v03_model_adaptation.html">Adapt your model</a></li>
    <li><a class="dropdown-item" href="articles/v04_compartment_properties.html">Play with compartment properties</a></li>
    <li><a class="dropdown-item" href="articles/v05_parameters.html">Adapt your parameters</a></li>
    <li><a class="dropdown-item" href="articles/v06_append_pd_model.html">Append a model to another</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Calvagone/campsismod/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header">
<img src="logo.png" class="logo" alt=""><h1 id="campsismod-">campsismod <a class="anchor" aria-label="anchor" href="#campsismod-"></a>
</h1>
</div>
<!-- badges: start -->

<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>Install the latest stable release using <code>devtools</code>:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"Calvagone/campsismod"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="basic-examples">Basic examples<a class="anchor" aria-label="anchor" href="#basic-examples"></a>
</h2>
<div class="section level3">
<h3 id="load-example-from-model-library">Load example from model library<a class="anchor" aria-label="anchor" href="#load-example-from-model-library"></a>
</h3>
<p>Load 2-compartment PK model from built-in model library:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/Calvagone/campsismod" class="external-link">campsismod</a></span><span class="op">)</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="va">model_suite</span><span class="op">$</span><span class="va">pk</span><span class="op">$</span><span class="va">`2cpt_fo`</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="write-campsis-model">Write CAMPSIS model<a class="anchor" aria-label="anchor" href="#write-campsis-model"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model</span> <span class="op"><a href="reference/grapes-greater-than-grapes.html">%&gt;%</a></span> <span class="fu"><a href="reference/write.html">write</a></span><span class="op">(</span>file<span class="op">=</span><span class="st">"path_to_model_folder"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="st">"path_to_model_folder"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "model.campsis" "omega.csv"     "sigma.csv"     "theta.csv"</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="read-and-show-campsis-model">Read and show CAMPSIS model<a class="anchor" aria-label="anchor" href="#read-and-show-campsis-model"></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/read.campsis.html">read.campsis</a></span><span class="op">(</span>file<span class="op">=</span><span class="st">"path_to_model_folder"</span><span class="op">)</span></span>
<span><span class="fu">show</span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span>
<span><span class="co">#&gt; [MAIN]</span></span>
<span><span class="co">#&gt; TVBIO=THETA_BIO</span></span>
<span><span class="co">#&gt; TVKA=THETA_KA</span></span>
<span><span class="co">#&gt; TVVC=THETA_VC</span></span>
<span><span class="co">#&gt; TVVP=THETA_VP</span></span>
<span><span class="co">#&gt; TVQ=THETA_Q</span></span>
<span><span class="co">#&gt; TVCL=THETA_CL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; BIO=TVBIO</span></span>
<span><span class="co">#&gt; KA=TVKA * exp(ETA_KA)</span></span>
<span><span class="co">#&gt; VC=TVVC * exp(ETA_VC)</span></span>
<span><span class="co">#&gt; VP=TVVP * exp(ETA_VP)</span></span>
<span><span class="co">#&gt; Q=TVQ * exp(ETA_Q)</span></span>
<span><span class="co">#&gt; CL=TVCL * exp(ETA_CL)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [ODE]</span></span>
<span><span class="co">#&gt; d/dt(A_ABS)=-KA*A_ABS</span></span>
<span><span class="co">#&gt; d/dt(A_CENTRAL)=KA*A_ABS + Q/VP*A_PERIPHERAL - Q/VC*A_CENTRAL - CL/VC*A_CENTRAL</span></span>
<span><span class="co">#&gt; d/dt(A_PERIPHERAL)=Q/VC*A_CENTRAL - Q/VP*A_PERIPHERAL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [F]</span></span>
<span><span class="co">#&gt; A_ABS=BIO</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [ERROR]</span></span>
<span><span class="co">#&gt; CONC=A_CENTRAL/VC</span></span>
<span><span class="co">#&gt; if (CONC &lt;= 0.001) CONC=0.001</span></span>
<span><span class="co">#&gt; CONC_ERR=CONC*(1 + EPS_PROP_RUV)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; THETA's:</span></span>
<span><span class="co">#&gt;   name index value   fix                            label unit</span></span>
<span><span class="co">#&gt; 1  BIO     1     1 FALSE                  Bioavailability &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 2   KA     2     1 FALSE                  Absorption rate  1/h</span></span>
<span><span class="co">#&gt; 3   VC     3    10 FALSE    Volume of central compartment    L</span></span>
<span><span class="co">#&gt; 4   VP     4    40 FALSE Volume of peripheral compartment    L</span></span>
<span><span class="co">#&gt; 5    Q     5    20 FALSE           Inter-compartment flow  L/h</span></span>
<span><span class="co">#&gt; 6   CL     6     3 FALSE                        Clearance  L/h</span></span>
<span><span class="co">#&gt; OMEGA's:</span></span>
<span><span class="co">#&gt;   name index index2 value   fix type</span></span>
<span><span class="co">#&gt; 1   KA     1      1    25 FALSE  cv%</span></span>
<span><span class="co">#&gt; 2   VC     2      2    25 FALSE  cv%</span></span>
<span><span class="co">#&gt; 3   VP     3      3    25 FALSE  cv%</span></span>
<span><span class="co">#&gt; 4    Q     4      4    25 FALSE  cv%</span></span>
<span><span class="co">#&gt; 5   CL     5      5    25 FALSE  cv%</span></span>
<span><span class="co">#&gt; SIGMA's:</span></span>
<span><span class="co">#&gt;       name index index2 value   fix type</span></span>
<span><span class="co">#&gt; 1 PROP_RUV     1      1   0.1 FALSE   sd</span></span>
<span><span class="co">#&gt; No variance-covariance matrix</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Compartments:</span></span>
<span><span class="co">#&gt; A_ABS (CMT=1)</span></span>
<span><span class="co">#&gt; A_CENTRAL (CMT=2)</span></span>
<span><span class="co">#&gt; A_PERIPHERAL (CMT=3)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="simulate-with-rxode2-or-mrgsolve">Simulate with rxode2 or mrgsolve<a class="anchor" aria-label="anchor" href="#simulate-with-rxode2-or-mrgsolve"></a>
</h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/Calvagone/campsis" class="external-link">campsis</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">dataset</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://calvagone.github.io/campsis.doc/reference/Dataset.html" class="external-link">Dataset</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span> <span class="op"><a href="reference/grapes-greater-than-grapes.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="reference/add.html">add</a></span><span class="op">(</span><span class="fu"><a href="https://calvagone.github.io/campsis.doc/reference/Bolus.html" class="external-link">Bolus</a></span><span class="op">(</span>time<span class="op">=</span><span class="fl">0</span>, amount<span class="op">=</span><span class="fl">1000</span>, ii<span class="op">=</span><span class="fl">12</span>, addl<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="reference/grapes-greater-than-grapes.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="reference/add.html">add</a></span><span class="op">(</span><span class="fu"><a href="https://calvagone.github.io/campsis.doc/reference/Observations.html" class="external-link">Observations</a></span><span class="op">(</span>times<span class="op">=</span><span class="fl">0</span><span class="op">:</span><span class="fl">36</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">rxode</span> <span class="op">&lt;-</span> <span class="va">model</span> <span class="op"><a href="reference/grapes-greater-than-grapes.html">%&gt;%</a></span> <span class="fu"><a href="https://calvagone.github.io/campsis.doc/reference/simulate.html" class="external-link">simulate</a></span><span class="op">(</span>dataset<span class="op">=</span><span class="va">dataset</span>, dest<span class="op">=</span><span class="st">"rxode2"</span>, seed<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">mrgsolve</span> <span class="op">&lt;-</span> <span class="va">model</span> <span class="op"><a href="reference/grapes-greater-than-grapes.html">%&gt;%</a></span> <span class="fu"><a href="https://calvagone.github.io/campsis.doc/reference/simulate.html" class="external-link">simulate</a></span><span class="op">(</span>dataset<span class="op">=</span><span class="va">dataset</span>, dest<span class="op">=</span><span class="st">"mrgsolve"</span>, seed<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://calvagone.github.io/campsis.doc/reference/spaghettiPlot.html" class="external-link">spaghettiPlot</a></span><span class="op">(</span><span class="va">rxode</span>, <span class="st">"CONC"</span><span class="op">)</span></span></code></pre></div>
<figure><img src="articles/resources/results_rxode.png" alt="rxode2 simulation results"><figcaption aria-hidden="true">
rxode2 simulation results
</figcaption></figure><div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://calvagone.github.io/campsis.doc/reference/spaghettiPlot.html" class="external-link">spaghettiPlot</a></span><span class="op">(</span><span class="va">mrgsolve</span>, <span class="st">"CONC"</span><span class="op">)</span></span></code></pre></div>
<figure><img src="articles/resources/results_mrgsolve.png" alt="mrgsolve simulation results"><figcaption aria-hidden="true">
mrgsolve simulation results
</figcaption></figure>
</div>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=campsismod" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/Calvagone/campsismod/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/Calvagone/campsismod/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>GPL (&gt;= 3)</small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing campsismod</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Nicolas Luyckx <br><small class="roles"> Author, maintainer </small>   </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Nicolas Luyckx.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.9000.</p>
</div>

    </footer>
</div>





  </body>
</html>
